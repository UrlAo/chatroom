# 私聊一对一视频通话功能测试指南

## 功能概述

本项目现已修复并完善了一对一私聊视频通话功能，允许两个用户在私聊界面中发起和接受视频通话。

## 测试步骤

### 1. 启动服务器

1. 运行 `gui_server.py` 启动聊天室服务器
2. 点击"服务器"菜单 -> "启动服务器"
3. 输入端口号（默认 8888）

### 2. 启动两个客户端

1. 运行 `gui_client.py` 启动第一个客户端
2. 连接到服务器并设置用户名（如：UserA）
3. 再次运行 `gui_client.py` 启动第二个客户端
4. 连接到同一服务器并设置不同用户名（如：UserB）

### 3. 测试私聊视频通话功能

#### 发起私聊

1. 在 UserA 客户端，从用户列表中点击 UserB，进入与 UserB 的私聊界面
2. 在 UserB 客户端，从用户列表中点击 UserA，进入与 UserA 的私聊界面

#### 发起视频通话

1. 在 UserA 的私聊界面中，点击底部工具栏的视频通话按钮（🎥）
2. 系统会弹出确认对话框："确定要向 UserB 发起视频通话吗？"
3. 点击"是"确认发起视频通话

#### 接受视频通话

1. UserB 会立即收到视频通话邀请弹窗："UserA 邀请您进行视频通话，是否接受？"
2. 点击"是"接受视频通话，或点击"否"拒绝通话
3. 如果接受，双方都会看到视频通话窗口，开始一对一视频通话

#### 结束视频通话

1. 任一方都可以点击"挂断视频通话"按钮（在"视频通话"菜单中）
2. 视频通话结束后，双方都会收到通知

### 4. 预期结果

- 发起方点击视频通话按钮后，接收方应立即收到弹窗邀请
- 接收方可选择接受或拒绝视频通话
- 接受后，双方都能看到对方的视频画面
- 摄像头和麦克风应正常工作
- 通话结束后，视频窗口正确关闭

### 5. 错误处理

- 如果接收方摄像头不可用，会显示错误提示并自动拒绝通话
- 如果网络连接有问题，会有相应错误提示
- 如果一方已在视频通话中，尝试发起新通话会收到警告

### 6. 故障排除

- 如果没有收到弹窗邀请，请检查：
  1. 两个客户端都已连接到服务器
  2. 接收方用户名拼写正确
  3. 网络连接稳定
  4. 客户端没有被最小化或阻塞
- 如果视频无法显示，请检查摄像头权限
- 如果音频有问题，请检查麦克风设置
